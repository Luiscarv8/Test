-- YTD Revenue
DECLARE @DATE TABLE (Quarter_Year char(7), DateKey int, Rank int, Dense_Rank int)
INSERT INTO @DATE
SELECT DISTINCT 
Quarter_Year, DateKey, RANK() OVER(ORDER BY DateKey ASC )  AS Rank, DENSE_RANK() OVER(PARTITION BY Quarter_Year ORDER BY DateKey ASC) Dense_Rank
FROM DIM.DATE 
WHERE Year = (SELECT DISTINCT Year FROM DIM.DATE d WHERE d.DateKey=(SELECT max(asofdatekey) FROM fact.vw_BORROWING))
AND Last_Day_Of_Month = 'Last Day Of Month'

DECLARE @CurrentPeriod                                int   = (Select MAX(asofdatekey) from [FACT].[BORROWING])
DECLARE @CurrentMonth                                                      int  = (Select LEFT(RIGHT(@CurrentPeriod,4),2))
DECLARE @CurrentYear                                                          int  = (Select LEFT(@CurrentPeriod,4))
DECLARE @BaselineYear                                                        int  = (Select @CurrentYear - 1)
DECLARE @MonthDenominator                                           int  = 12
DECLARE @January                                                                  int  = (Select B.DateKey From (Select A.DateKey, RANK() OVER( ORDER BY A.DateKey DESC) As Rank From (Select Distinct Top 12 Datekey FROM [DIM].[DATE] WHERE Last_Day_Of_Month = 'Last Day of Month' and Year = @CurrentYear ORDER BY DateKey ASC) A) B Where Rank = 12)
DECLARE @February                                                                int  = (Select B.DateKey From (Select A.DateKey, RANK() OVER( ORDER BY A.DateKey DESC) As Rank From (Select Distinct Top 12 Datekey FROM [DIM].[DATE] WHERE Last_Day_Of_Month = 'Last Day of Month' and Year = @CurrentYear ORDER BY DateKey ASC) A) B Where Rank = 11)
DECLARE @March                                                                                    int  = (Select B.DateKey From (Select A.DateKey, RANK() OVER( ORDER BY A.DateKey DESC) As Rank From (Select Distinct Top 12 Datekey FROM [DIM].[DATE] WHERE Last_Day_Of_Month = 'Last Day of Month' and Year = @CurrentYear ORDER BY DateKey ASC) A) B Where Rank = 10)
DECLARE @April                                                                                       int  = (Select B.DateKey From (Select A.DateKey, RANK() OVER( ORDER BY A.DateKey DESC) As Rank From (Select Distinct Top 12 Datekey FROM [DIM].[DATE] WHERE Last_Day_Of_Month = 'Last Day of Month' and Year = @CurrentYear ORDER BY DateKey ASC) A) B Where Rank =  9)
DECLARE @May                                                                                        int  = (Select B.DateKey From (Select A.DateKey, RANK() OVER( ORDER BY A.DateKey DESC) As Rank From (Select Distinct Top 12 Datekey FROM [DIM].[DATE] WHERE Last_Day_Of_Month = 'Last Day of Month' and Year = @CurrentYear ORDER BY DateKey ASC) A) B Where Rank =  8)
DECLARE @June                                                                                       int  = (Select B.DateKey From (Select A.DateKey, RANK() OVER( ORDER BY A.DateKey DESC) As Rank From (Select Distinct Top 12 Datekey FROM [DIM].[DATE] WHERE Last_Day_Of_Month = 'Last Day of Month' and Year = @CurrentYear ORDER BY DateKey ASC) A) B Where Rank =  7)
DECLARE @July                                                                                         int  = (Select B.DateKey From (Select A.DateKey, RANK() OVER( ORDER BY A.DateKey DESC) As Rank From (Select Distinct Top 12 Datekey FROM [DIM].[DATE] WHERE Last_Day_Of_Month = 'Last Day of Month' and Year = @CurrentYear ORDER BY DateKey ASC) A) B Where Rank =  6)
DECLARE @August                                                                                  int  = (Select B.DateKey From (Select A.DateKey, RANK() OVER( ORDER BY A.DateKey DESC) As Rank From (Select Distinct Top 12 Datekey FROM [DIM].[DATE] WHERE Last_Day_Of_Month = 'Last Day of Month' and Year = @CurrentYear ORDER BY DateKey ASC) A) B Where Rank =  5)
DECLARE @September                                                                           int  = (Select B.DateKey From (Select A.DateKey, RANK() OVER( ORDER BY A.DateKey DESC) As Rank From (Select Distinct Top 12 Datekey FROM [DIM].[DATE] WHERE Last_Day_Of_Month = 'Last Day of Month' and Year = @CurrentYear ORDER BY DateKey ASC) A) B Where Rank =  4)
DECLARE @October                                                                 int  = (Select B.DateKey From (Select A.DateKey, RANK() OVER( ORDER BY A.DateKey DESC) As Rank From (Select Distinct Top 12 Datekey FROM [DIM].[DATE] WHERE Last_Day_Of_Month = 'Last Day of Month' and Year = @CurrentYear ORDER BY DateKey ASC) A) B Where Rank =  3)
DECLARE @November                                                             int  = (Select B.DateKey From (Select A.DateKey, RANK() OVER( ORDER BY A.DateKey DESC) As Rank From (Select Distinct Top 12 Datekey FROM [DIM].[DATE] WHERE Last_Day_Of_Month = 'Last Day of Month' and Year = @CurrentYear ORDER BY DateKey ASC) A) B Where Rank =  2)
DECLARE @December                                                                            int  = (Select B.DateKey From (Select A.DateKey, RANK() OVER( ORDER BY A.DateKey DESC) As Rank From (Select Distinct Top 12 Datekey FROM [DIM].[DATE] WHERE Last_Day_Of_Month = 'Last Day of Month' and Year = @CurrentYear ORDER BY DateKey ASC) A) B Where Rank =  1)
DECLARE @CurrentQuarter VarChar(2) = (SELECT DISTINCT LEFT(Quarter_Year,2) FROM DIM.DATE d WHERE d.DateKey=(SELECT MAX(asofdatekey) FROM fact.vw_BORROWING))
DECLARE @CurrentMonthRank float = (SELECT DISTINCT Rank FROM @DATE WHERE Datekey = @CurrentPeriod)
DECLARE @CurrentMonthDenseRank int = (SELECT DISTINCT Dense_Rank FROM @DATE WHERE DateKey = @CurrentMonth)
DECLARE @MonthlyDivisor numeric(38,2) = 3
--Select @CurrentPeriod As CurrPeriod, @CurrentMonth As CurrMonth, @CurrentYear as CurrYear, @BaselineAdjustmentDate As BaselineAdjustmentDate, @BaselineYear as BaselineYear, @BaselineAdjustmentDate as BaselineAdjustmentDate, @MonthDenominator as MonthDenominator
Declare @BankerGoalYear varchar(4) = @CurrentYear



----- ################### GOALS
select * INTO #GOALS from (

Select 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) CurrLevelID, Banker_Goal_Year 
, Case When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  END AS YTD_Deposit_Growth_Goal
, Case When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  END AS YTD_Loan_Growth_Goal,
                  (SUM(ISNULL([Revenue_Goal_1Q],0))+SUM(ISNULL(Revenue_Goal_2Q,0))+SUM(ISNULL(Revenue_Goal_3Q,0))+SUM(ISNULL(Revenue_Goal_4Q,0))) * CAST(@CurrentMonthRank/12 as float) as YTD_Revenue_Goal,
                  SUM(Annual_Revenue_Growth_Goal) Annual_Revenue_Growth_Goal
FROM [FACT].[BANKER_GOAL] f
  join dim.date d on f.AsOfDateKey=d.DateKey
  join dim.employee e on e.employeekey=f.currentofficerKey
WHERE Banker_Goal_Year = @CurrentYear
GROUP BY substring(replace(e.Current_LevelKey,'|',''),13,6), Banker_Goal_Year
UNION ALL
Select 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) CurrLevelID, Banker_Goal_Year 
, Case When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  END AS YTD_Deposit_Growth_Goal
, Case When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  END AS YTD_Loan_Growth_Goal,
                  (SUM(ISNULL([Revenue_Goal_1Q],0))+SUM(ISNULL(Revenue_Goal_2Q,0))+SUM(ISNULL(Revenue_Goal_3Q,0))+SUM(ISNULL(Revenue_Goal_4Q,0))) * CAST(@CurrentMonthRank/12 as float) as YTD_Revenue_Goal,
                  SUM(Annual_Revenue_Growth_Goal) Annual_Revenue_Growth_Goal
FROM [FACT].[BANKER_GOAL] f
  join dim.date d on f.AsOfDateKey=d.DateKey
  join dim.employee e on e.employeekey=f.currentofficerKey
WHERE Banker_Goal_Year = @CurrentYear
GROUP BY substring(replace(e.Current_LevelKey,'|',''),19,6), Banker_Goal_Year
UNION ALL
Select 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) CurrLevelID, Banker_Goal_Year 
, Case When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  END AS YTD_Deposit_Growth_Goal
, Case When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  END AS YTD_Loan_Growth_Goal,
                 (SUM(ISNULL([Revenue_Goal_1Q],0))+SUM(ISNULL(Revenue_Goal_2Q,0))+SUM(ISNULL(Revenue_Goal_3Q,0))+SUM(ISNULL(Revenue_Goal_4Q,0))) * CAST(@CurrentMonthRank/12 as float) as YTD_Revenue_Goal,
                  SUM(Annual_Revenue_Growth_Goal) Annual_Revenue_Growth_Goal
FROM [FACT].[BANKER_GOAL] f
  join dim.date d on f.AsOfDateKey=d.DateKey
  join dim.employee e on e.employeekey=f.currentofficerKey
WHERE Banker_Goal_Year = @CurrentYear
GROUP BY substring(replace(e.Current_LevelKey,'|',''),25,6), Banker_Goal_Year
UNION ALL
Select 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) CurrLevelID, Banker_Goal_Year 
, Case When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  END AS YTD_Deposit_Growth_Goal
, Case When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  END AS YTD_Loan_Growth_Goal,
                  (SUM(ISNULL([Revenue_Goal_1Q],0))+SUM(ISNULL(Revenue_Goal_2Q,0))+SUM(ISNULL(Revenue_Goal_3Q,0))+SUM(ISNULL(Revenue_Goal_4Q,0))) * CAST(@CurrentMonthRank/12 as float) as YTD_Revenue_Goal,
                  SUM(Annual_Revenue_Growth_Goal) Annual_Revenue_Growth_Goal
FROM [FACT].[BANKER_GOAL] f
  join dim.date d on f.AsOfDateKey=d.DateKey
  join dim.employee e on e.employeekey=f.currentofficerKey
WHERE Banker_Goal_Year = @CurrentYear
GROUP BY substring(replace(e.Current_LevelKey,'|',''),31,6), Banker_Goal_Year
UNION ALL
Select 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) CurrLevelID, Banker_Goal_Year 
, Case When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  END AS YTD_Deposit_Growth_Goal
, Case When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  END AS YTD_Loan_Growth_Goal,
                  (SUM(ISNULL([Revenue_Goal_1Q],0))+SUM(ISNULL(Revenue_Goal_2Q,0))+SUM(ISNULL(Revenue_Goal_3Q,0))+SUM(ISNULL(Revenue_Goal_4Q,0))) * CAST(@CurrentMonthRank/12 as float) as YTD_Revenue_Goal,
                  SUM(Annual_Revenue_Growth_Goal) Annual_Revenue_Growth_Goal
FROM [FACT].[BANKER_GOAL] f
  join dim.date d on f.AsOfDateKey=d.DateKey
  join dim.employee e on e.employeekey=f.currentofficerKey
WHERE Banker_Goal_Year = @CurrentYear
GROUP BY substring(replace(e.Current_LevelKey,'|',''),37,6), Banker_Goal_Year
UNION ALL
Select 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) CurrLevelID, Banker_Goal_Year 
, Case When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  END AS YTD_Deposit_Growth_Goal
, Case When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  END AS YTD_Loan_Growth_Goal,
                  (SUM(ISNULL([Revenue_Goal_1Q],0))+SUM(ISNULL(Revenue_Goal_2Q,0))+SUM(ISNULL(Revenue_Goal_3Q,0))+SUM(ISNULL(Revenue_Goal_4Q,0))) * CAST(@CurrentMonthRank/12 as float) as YTD_Revenue_Goal,
                  SUM(Annual_Revenue_Growth_Goal) Annual_Revenue_Growth_Goal
FROM [FACT].[BANKER_GOAL] f
  join dim.date d on f.AsOfDateKey=d.DateKey
  join dim.employee e on e.employeekey=f.currentofficerKey
WHERE Banker_Goal_Year = @CurrentYear
GROUP BY substring(replace(e.Current_LevelKey,'|',''),43,6), Banker_Goal_Year
UNION ALL
Select 9 Level, substring(replace(e.Current_LevelKey,'|',''),50,6) CurrLevelID, Banker_Goal_Year 
, Case When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  END AS YTD_Deposit_Growth_Goal
, Case When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  END AS YTD_Loan_Growth_Goal,
                  (SUM(ISNULL([Revenue_Goal_1Q],0))+SUM(ISNULL(Revenue_Goal_2Q,0))+SUM(ISNULL(Revenue_Goal_3Q,0))+SUM(ISNULL(Revenue_Goal_4Q,0))) * CAST(@CurrentMonthRank/12 as float) as YTD_Revenue_Goal,
                  SUM(Annual_Revenue_Growth_Goal) Annual_Revenue_Growth_Goal
FROM [FACT].[BANKER_GOAL] f
  join dim.date d on f.AsOfDateKey=d.DateKey
  join dim.employee e on e.employeekey=f.currentofficerKey
WHERE Banker_Goal_Year = @CurrentYear
GROUP BY substring(replace(e.Current_LevelKey,'|',''),50,6), Banker_Goal_Year
UNION ALL
Select 0 Level, e.Officer_ID CurrLevelID, Banker_Goal_Year 
, Case When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Deposit_Growth_Goal_1Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_2Q,0))+ SUM(ISNULL(Deposit_Growth_Goal_3Q,0))+(SUM(ISNULL(Deposit_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  END AS YTD_Deposit_Growth_Goal
, Case When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '1Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))/@MonthlyDivisor) *@CurrentMonthDenseRank
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '2Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+(SUM(ISNULL(Loan_Growth_Goal_2Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '3Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+(SUM(ISNULL(Loan_Growth_Goal_3Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 1) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 2) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  When (@CurrentQuarter = '4Q' AND @CurrentMonthDenseRank = 3) THEN (SUM(ISNULL(Loan_Growth_Goal_1Q,0))+ SUM(ISNULL(Loan_Growth_Goal_2Q,0))+ SUM(ISNULL(Loan_Growth_Goal_3Q,0))+(SUM(ISNULL(Loan_Growth_Goal_4Q,0)))/@MonthlyDivisor *@CurrentMonthDenseRank)
                  END AS YTD_Loan_Growth_Goal,
                  (SUM(ISNULL([Revenue_Goal_1Q],0))+SUM(ISNULL(Revenue_Goal_2Q,0))+SUM(ISNULL(Revenue_Goal_3Q,0))+SUM(ISNULL(Revenue_Goal_4Q,0))) * CAST(@CurrentMonthRank/12 as float) as YTD_Revenue_Goal,
                  SUM(Annual_Revenue_Growth_Goal) Annual_Revenue_Growth_Goal
FROM [FACT].[BANKER_GOAL] f
  join dim.date d on f.AsOfDateKey=d.DateKey
  join dim.employee e on e.employeekey=f.currentofficerKey
WHERE Banker_Goal_Year = @CurrentYear 
GROUP BY e.Officer_ID, Banker_Goal_Year
) x
where CurrLevelID !=''
-- ################### END GOALS

SELECT Level, CurrLevelID, x.AsOfDateKey
, CASE WHEN SpreadType = 'Spread Income Assets'                   THEN SUM(Net_Spread_Margin)           ELSE 0 END Asset_Net_Spread_Margin
, CASE WHEN SpreadType = 'Spread Income Liabilities' THEN SUM(Net_Spread_Margin)               ELSE 0 END Liability_Net_Spread_Margin
, SUM(Net_Loan_Fees)                                                                             Net_Loan_Fees
, SUM(Net_Depository_Fees)                                                  Net_Depository_Fees
, SUM(Letter_Of_Credit_Fees)                                                Letter_Of_Credit_Fees
, SUM(Treasury_Management_Hard_Charges)                 Treasury_Management_Hard_Charges
, SUM(Wealth_Management_Revenue)                                              Wealth_Management_Revenue
, SUM(Card_Services_Net_Revenue)                                   Card_Services_Net_Revenue
, SUM(Card_Services_Fees)                                                                   Card_Services_Fees
, SUM(Net_Merchant_Services_Fees)                                  Net_Merchant_Services_Fees
, SUM(Equipment_Finance_Revenue)                                 Equipment_Finance_Revenue
, SUM(Total_Fee_Revenue)                                                                     Total_Fee_Revenue 
, SUM(Manually_Captured_Revenue)                                  Manually_Captured_Revenue
, SUM(Total_Net_Revenue)                                                                     Total_Net_Revenue
, SUM(Expected_Loss) * -1                                                                     Expected_Loss
, SUM(CASE WHEN systemkey=7 OR (pp.Product_Use='Personal' and Officer_Management_Segment in ('Commercial Banking','Commercial Real Estate Banking','Middle Market Banking'
               ,'Reserved Based Lending','Corporate Banking','Healthcare Banking','Developer Real Estate Banking','Multiple/Other'))
               then Total_Net_Revenue*-1 else 0 end) Excluded_Consumer_Revenue
, SUM(Net_Spread_Margin)
+ SUM(Total_Fee_Revenue)
+ SUM(Manually_Captured_Revenue)
+ SUM(CASE WHEN systemkey=7 OR (pp.Product_Use='Personal' and Officer_Management_Segment in ('Commercial Banking','Commercial Real Estate Banking','Middle Market Banking'
               ,'Reserved Based Lending','Corporate Banking','Healthcare Banking','Developer Real Estate Banking','Multiple/Other'))
               then Total_Net_Revenue*-1 else 0 end)
+ SUM(Expected_Loss) * -1                                                                   Total_Performance_Revenue
FROM 
( 
-- Level 3
--LOANS
SELECT 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Assets' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_LOAN] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),13,6) and g.Level=Level
                              WHERE Year = @CurrentYear 

UNION ALL
-- CREDIT CARDS
SELECT 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Assets' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_CREDIT_CARD] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),13,6) and g.Level=Level
                              WHERE Year = @CurrentYear 

UNION ALL
--DEMAND DEPOSIT
SELECT 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_DEMAND_DEPOSIT] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),13,6) and g.Level=Level
                              WHERE Year = @CurrentYear 

UNION ALL
-- TIME DEPOSIT
SELECT 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_TIME_DEPOSIT] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),13,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
--                           
-- BORROWINGS
UNION ALL
SELECT 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_BORROWING] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),13,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
----                        
UNION ALL
--MANUALLY CAPTURED REVENUE
SELECT 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue 
, Adjustment_Amount As Manually_Captured_Revenue 
, 0 Net_Merchant_Services_Fees
, 0 Total_Fee_Revenue
, 0 Total_Net_Revenue
, 0 Expected_Loss
, 0 Adjustment_Amount
FROM [FACT].[MANUALLY_CAPTURED_REVENUE] f
join dim.EMPLOYEE e on e.EmployeeKey=f.currentofficerKey join dim.date d on asofdatekey=datekey
join dim.TRANSACTION_TYPE t on t.TransactionTypeKey=f.TransactionTypeKey
-- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),13,6) and g.Level=Level
WHERE Year = @CurrentYear 

--MERCHANT SERVICES
UNION ALL
SELECT 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue
, 0 Manually_Captured_Revenue
, Net_Merchant_Services_Fees Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, 0 Expected_Loss
, 0 Adjustment_Amount
FROM [FACT].[vw_MERCHANT_SERVICE] f
join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
-- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),13,6) and g.Level=Level
WHERE Year = @CurrentYear 

UNION ALL
--Incentive Adjustment
SELECT 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, 0 Total_Fee_Revenue
, Adjustment_Amount  Total_Net_Revenue
, 0 Expected_Loss
, Adjustment_Amount as Adjustment_Amount 
FROM [FACT].[MANUAL_ADJUSTMENT] f
join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
join dim.TRANSACTION_TYPE t on t.TransactionTypeKey=f.TransactionTypeKey
-- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),13,6) and g.Level=Level
WHERE Year = @CurrentYear 
And f.TransactionTypeKey = 10 

UNION ALL
-- Level 4
--LOANS
SELECT 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Assets' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_LOAN] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),19,6) and g.Level=Level
                              WHERE Year = @CurrentYear 


UNION ALL
-- CREDIT CARDS
SELECT 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Assets' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_CREDIT_CARD] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),19,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                              

UNION ALL
--DEMAND DEPOSIT
SELECT 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_DEMAND_DEPOSIT] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),19,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                               
UNION ALL
-- TIME DEPOSIT
SELECT 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_TIME_DEPOSIT] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),19,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                              
-- BORROWINGS
UNION ALL
SELECT 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_BORROWING] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),19,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                              
UNION ALL
--MANUALLY CAPTURED REVENUE
SELECT 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue 
, Adjustment_Amount As Manually_Captured_Revenue 
, 0 Net_Merchant_Services_Fees
, 0 Total_Fee_Revenue
, 0 Total_Net_Revenue
, 0 Expected_Loss
, 0 Adjustment_Amount
FROM [FACT].[MANUALLY_CAPTURED_REVENUE] f
join dim.EMPLOYEE e on e.EmployeeKey=f.currentofficerKey join dim.date d on asofdatekey=datekey
join dim.TRANSACTION_TYPE t on t.TransactionTypeKey=f.TransactionTypeKey
-- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),19,6) and g.Level=Level
WHERE Year = @CurrentYear 

--MERCHANT SERVICES
UNION ALL
SELECT 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue
, 0 Manually_Captured_Revenue
, Net_Merchant_Services_Fees Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, 0 Expected_Loss
, 0 Adjustment_Amount
FROM [FACT].[vw_MERCHANT_SERVICE] f
join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
-- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),19,6) and g.Level=Level
WHERE Year = @CurrentYear 

UNION ALL
--Incentive Adjustment
SELECT 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, 0 Total_Fee_Revenue
, Adjustment_Amount  Total_Net_Revenue
, 0 Expected_Loss
, Adjustment_Amount as Adjustment_Amount 
FROM [FACT].[MANUAL_ADJUSTMENT] f
join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
join dim.TRANSACTION_TYPE t on t.TransactionTypeKey=f.TransactionTypeKey
-- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),19,6) and g.Level=Level
WHERE Year = @CurrentYear 
And f.TransactionTypeKey = 10 

UNION ALL
--Level 5
--LOANS
SELECT 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Assets' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_LOAN] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),25,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                               

UNION ALL
-- CREDIT CARDS
SELECT 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Assets' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_CREDIT_CARD] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),25,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                              

UNION ALL
--DEMAND DEPOSIT
SELECT 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_DEMAND_DEPOSIT] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),25,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                               
UNION ALL
-- TIME DEPOSIT
SELECT 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_TIME_DEPOSIT] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),25,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                              
-- BORROWINGS
UNION ALL
SELECT 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_BORROWING] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),25,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                              
UNION ALL
--MANUALLY CAPTURED REVENUE
SELECT 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue 
, Adjustment_Amount As Manually_Captured_Revenue 
, 0 Net_Merchant_Services_Fees
, 0 Total_Fee_Revenue
, 0 Total_Net_Revenue
, 0 Expected_Loss
, 0 Adjustment_Amount
FROM [FACT].[MANUALLY_CAPTURED_REVENUE] f
join dim.EMPLOYEE e on e.EmployeeKey=f.currentofficerKey join dim.date d on asofdatekey=datekey
join dim.TRANSACTION_TYPE t on t.TransactionTypeKey=f.TransactionTypeKey
-- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),25,6) and g.Level=Level
WHERE Year = @CurrentYear 

--MERCHANT SERVICES
UNION ALL
SELECT 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue
, 0 Manually_Captured_Revenue
, Net_Merchant_Services_Fees Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, 0 Expected_Loss
, 0 Adjustment_Amount
FROM [FACT].[vw_MERCHANT_SERVICE] f
join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
-- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),25,6) and g.Level=Level
WHERE Year = @CurrentYear 

UNION ALL
--Incentive Adjustment
SELECT 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, 0 Total_Fee_Revenue
, Adjustment_Amount  Total_Net_Revenue
, 0 Expected_Loss
, Adjustment_Amount as Adjustment_Amount 
FROM [FACT].[MANUAL_ADJUSTMENT] f
join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
join dim.TRANSACTION_TYPE t on t.TransactionTypeKey=f.TransactionTypeKey
-- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),25,6) and g.Level=Level
WHERE Year = @CurrentYear 
And f.TransactionTypeKey = 10 

UNION ALL
--Level 6
--LOANS
SELECT 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Assets' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_LOAN] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),31,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                               

UNION ALL
-- CREDIT CARDS
SELECT 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Assets' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_CREDIT_CARD] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),31,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                              

UNION ALL
--DEMAND DEPOSIT
SELECT 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_DEMAND_DEPOSIT] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),31,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                               
UNION ALL
-- TIME DEPOSIT
SELECT 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_TIME_DEPOSIT] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),31,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                              
-- BORROWINGS
UNION ALL
SELECT 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_BORROWING] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),31,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                              
UNION ALL
--MANUALLY CAPTURED REVENUE
SELECT 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue 
, Adjustment_Amount As Manually_Captured_Revenue 
, 0 Net_Merchant_Services_Fees
, 0 Total_Fee_Revenue
, 0 Total_Net_Revenue
, 0 Expected_Loss
, 0 Adjustment_Amount
FROM [FACT].[MANUALLY_CAPTURED_REVENUE] f
join dim.EMPLOYEE e on e.EmployeeKey=f.currentofficerKey join dim.date d on asofdatekey=datekey
join dim.TRANSACTION_TYPE t on t.TransactionTypeKey=f.TransactionTypeKey
-- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),31,6) and g.Level=Level
WHERE Year = @CurrentYear 

--MERCHANT SERVICES
UNION ALL
SELECT 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue
, 0 Manually_Captured_Revenue
, Net_Merchant_Services_Fees Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, 0 Expected_Loss
, 0 Adjustment_Amount
FROM [FACT].[vw_MERCHANT_SERVICE] f
join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
-- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),31,6) and g.Level=Level
WHERE Year = @CurrentYear 

UNION ALL
--Incentive Adjustment
SELECT 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, 0 Total_Fee_Revenue
, Adjustment_Amount  Total_Net_Revenue
, 0 Expected_Loss
, Adjustment_Amount as Adjustment_Amount 
FROM [FACT].[MANUAL_ADJUSTMENT] f
join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
join dim.TRANSACTION_TYPE t on t.TransactionTypeKey=f.TransactionTypeKey
-- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),31,6) and g.Level=Level
WHERE Year = @CurrentYear 
And f.TransactionTypeKey = 10 

UNION ALL
--Level 7
--LOANS
SELECT 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Assets' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_LOAN] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),37,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                               

UNION ALL
-- CREDIT CARDS
SELECT 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Assets' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_CREDIT_CARD] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                              --  -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),37,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                              

UNION ALL
--DEMAND DEPOSIT
SELECT 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_DEMAND_DEPOSIT] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                              --  -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),37,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                               
UNION ALL
-- TIME DEPOSIT
SELECT 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_TIME_DEPOSIT] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                              --  -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),37,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                              
-- BORROWINGS
UNION ALL
SELECT 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_BORROWING] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                              --  -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),37,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                              
UNION ALL
--MANUALLY CAPTURED REVENUE
SELECT 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue 
, Adjustment_Amount As Manually_Captured_Revenue 
, 0 Net_Merchant_Services_Fees
, 0 Total_Fee_Revenue
, 0 Total_Net_Revenue
, 0 Expected_Loss
, 0 Adjustment_Amount
FROM [FACT].[MANUALLY_CAPTURED_REVENUE] f
join dim.EMPLOYEE e on e.EmployeeKey=f.currentofficerKey join dim.date d on asofdatekey=datekey
join dim.TRANSACTION_TYPE t on t.TransactionTypeKey=f.TransactionTypeKey
  -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),37,6) and g.Level=Level
WHERE Year = @CurrentYear 

--MERCHANT SERVICES
UNION ALL
SELECT 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue
, 0 Manually_Captured_Revenue
, Net_Merchant_Services_Fees Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, 0 Expected_Loss
, 0 Adjustment_Amount
FROM [FACT].[vw_MERCHANT_SERVICE] f
join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
  -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),37,6) and g.Level=Level
WHERE Year = @CurrentYear 

UNION ALL
--Incentive Adjustment
SELECT 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, 0 Total_Fee_Revenue
, Adjustment_Amount  Total_Net_Revenue
, 0 Expected_Loss
, Adjustment_Amount as Adjustment_Amount 
FROM [FACT].[MANUAL_ADJUSTMENT] f
join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
join dim.TRANSACTION_TYPE t on t.TransactionTypeKey=f.TransactionTypeKey
  -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),37,6) and g.Level=Level
WHERE Year = @CurrentYear 
And f.TransactionTypeKey = 10 

UNION ALL
--Level 8
--LOANS
SELECT 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Assets' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_LOAN] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                              --  -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),43,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                               

UNION ALL
-- CREDIT CARDS
SELECT 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Assets' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_CREDIT_CARD] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),43,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                              

UNION ALL
--DEMAND DEPOSIT
SELECT 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_DEMAND_DEPOSIT] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),43,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                              
UNION ALL
-- TIME DEPOSIT
SELECT 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_TIME_DEPOSIT] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),43,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                              
-- BORROWINGS
UNION ALL
SELECT 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_BORROWING] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),43,6) and g.Level=Level
                              WHERE Year = @CurrentYear 
                              
UNION ALL
--MANUALLY CAPTURED REVENUE
SELECT 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue 
, Adjustment_Amount As Manually_Captured_Revenue 
, 0 Net_Merchant_Services_Fees
, 0 Total_Fee_Revenue
, 0 Total_Net_Revenue
, 0 Expected_Loss
, 0 Adjustment_Amount
FROM [FACT].[MANUALLY_CAPTURED_REVENUE] f
join dim.EMPLOYEE e on e.EmployeeKey=f.currentofficerKey join dim.date d on asofdatekey=datekey
join dim.TRANSACTION_TYPE t on t.TransactionTypeKey=f.TransactionTypeKey
-- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),43,6) and g.Level=Level
WHERE Year = @CurrentYear 

--MERCHANT SERVICES
UNION ALL
SELECT 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue
, 0 Manually_Captured_Revenue
, Net_Merchant_Services_Fees Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, 0 Expected_Loss
, 0 Adjustment_Amount
FROM [FACT].[vw_MERCHANT_SERVICE] f
join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
-- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),43,6) and g.Level=Level
WHERE Year = @CurrentYear 

UNION ALL
--Incentive Adjustment
SELECT 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, 0 Total_Fee_Revenue
, Adjustment_Amount  Total_Net_Revenue
, 0 Expected_Loss
, Adjustment_Amount as Adjustment_Amount 
FROM [FACT].[MANUAL_ADJUSTMENT] f
join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
join dim.TRANSACTION_TYPE t on t.TransactionTypeKey=f.TransactionTypeKey
-- join #GOALS g on g.CurrLevelID=substring(replace(e.Current_LevelKey,'|',''),43,6) and g.Level=Level
WHERE Year = @CurrentYear 
And f.TransactionTypeKey = 10 

UNION ALL
--Level 0
--LOANS
SELECT 0 Level, e.Officer_ID as CurrLevelID, f.AsOfDateKey, 'Spread Income Assets' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_LOAN] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=Officer_ID and g.Level=Level
                              WHERE Year = @CurrentYear 
               

UNION ALL
-- CREDIT CARDS
SELECT 0 Level, e.Officer_ID as CurrLevelID, f.AsOfDateKey, 'Spread Income Assets' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_CREDIT_CARD] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=Officer_ID and g.Level=Level
                              WHERE Year = @CurrentYear 
                              

UNION ALL
--DEMAND DEPOSIT
SELECT 0 Level, e.Officer_ID as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_DEMAND_DEPOSIT] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=Officer_ID and g.Level=Level
                              WHERE Year = @CurrentYear 
                               
UNION ALL
-- TIME DEPOSIT
SELECT 0 Level, e.Officer_ID as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_TIME_DEPOSIT] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=Officer_ID and g.Level=Level
                              WHERE Year = @CurrentYear 
                              
-- BORROWINGS
UNION ALL
SELECT 0 Level, e.Officer_ID as CurrLevelID, f.AsOfDateKey, 'Spread Income Liabilities' SpreadType, Product_Use, p.Productkey, systemkey, f.currentofficerkey 
, Levelized_Spread_Margin Net_Spread_Margin
, Net_Loan_Fees  Net_Loan_Fees
, Net_Depository_Fees  Net_Depository_Fees
, Letter_Of_Credit_Fees  Letter_Of_Credit_Fees
, Treasury_Management_Hard_Charges Treasury_Management_Hard_Charges
, Wealth_Management_Revenue Wealth_Management_Revenue
, Card_Services_Net_Revenue Card_Services_Net_Revenue
, Card_Services_Fees Card_Services_Fees
, Equipment_Finance_Revenue Equipment_Finance_Revenue 
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, Expected_Loss Expected_Loss
,0 Adjustment_Amount
                   FROM [FACT].[vw_BORROWING] f
                              join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
                              join dim.product p on p.Productkey=f.Productkey
                                -- join #GOALS g on g.CurrLevelID=Officer_ID and g.Level=Level
                              WHERE Year = @CurrentYear 
                              
UNION ALL
--MANUALLY CAPTURED REVENUE
SELECT 0 Level, e.Officer_ID as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue 
, Adjustment_Amount As Manually_Captured_Revenue 
, 0 Net_Merchant_Services_Fees
, 0 Total_Fee_Revenue
, 0 Total_Net_Revenue
, 0 Expected_Loss
, 0 Adjustment_Amount
FROM [FACT].[MANUALLY_CAPTURED_REVENUE] f
join dim.EMPLOYEE e on e.EmployeeKey=f.currentofficerKey join dim.date d on asofdatekey=datekey
-- join #GOALS g on g.CurrLevelID=Officer_ID and g.Level=Level
join dim.TRANSACTION_TYPE t on t.TransactionTypeKey=f.TransactionTypeKey

WHERE Year = @CurrentYear 

--MERCHANT SERVICES
UNION ALL
SELECT 0 Level, e.Officer_ID as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue
, 0 Manually_Captured_Revenue
, Net_Merchant_Services_Fees Net_Merchant_Services_Fees
, Total_Fee_Revenue Total_Fee_Revenue
, Total_Net_Revenue  Total_Net_Revenue
, 0 Expected_Loss
, 0 Adjustment_Amount
FROM [FACT].[vw_MERCHANT_SERVICE] f
join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
-- join #GOALS g on g.CurrLevelID=Officer_ID and g.Level=Level
WHERE Year = @CurrentYear 

--Incentive Adjustment
UNION ALL
SELECT 0 Level, e.Officer_ID as CurrLevelID, f.AsofDateKey, '' SpreadType, '' Product_Use, Productkey, systemkey, f.currentofficerkey
, 0 Net_Spread_Margin
, 0 Net_Loan_Fees
, 0 Net_Depository_Fees
, 0 Letter_Of_Credit_Fees
, 0 Treasury_Management_Hard_Charges
, 0 Wealth_Management_Revenue
, 0 Card_Services_Net_Revenue
, 0 Card_Services_Fees
, 0 Equipment_Finance_Revenue
, 0 Manually_Captured_Revenue
, 0 Net_Merchant_Services_Fees
, 0 Total_Fee_Revenue
, Adjustment_Amount  Total_Net_Revenue
, 0 Expected_Loss
, Adjustment_Amount as Adjustment_Amount 
FROM [FACT].[MANUAL_ADJUSTMENT] f
join dim.employee e on e.employeekey=f.currentofficerKey join dim.date d on asofdatekey=datekey
join dim.TRANSACTION_TYPE t on t.TransactionTypeKey=f.TransactionTypeKey
-- join #GOALS g on g.CurrLevelID=Officer_ID and g.Level=Level
WHERE Year = @CurrentYear 
And f.TransactionTypeKey = 10 


) x
LEFT JOIN DIM.PRODUCT pp on pp.Productkey=x.Productkey
JOIN DIM.EMPLOYEE ee on ee.employeekey=x.currentofficerkey

WHERE Sales_Classification != 'Internal'
----and x.CurrLevelID = 'Z86'
GROUP BY Level, CurrLevelID, x.AsOfDateKey, SpreadType

UNION ALL
-- 0's added for every CurrLevelID to support SSRS Formatting
--Februray

SELECT DISTINCT 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) as CurrLevelID, @February AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) as CurrLevelID, @February AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) as CurrLevelID, @February AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) as CurrLevelID, @February AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) as CurrLevelID, @February AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) as CurrLevelID, @February AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 0 Level, e.Officer_ID as CurrLevelID, @February AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'


UNION ALL
SELECT DISTINCT 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) as CurrLevelID, @March AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) as CurrLevelID, @March AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) as CurrLevelID, @March AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) as CurrLevelID, @March AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) as CurrLevelID, @March AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) as CurrLevelID, @March AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 0 Level, e.Officer_ID as CurrLevelID, @March AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'


UNION ALL
SELECT DISTINCT 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) as CurrLevelID, @April AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) as CurrLevelID, @April AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) as CurrLevelID, @April AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) as CurrLevelID, @April AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) as CurrLevelID, @April AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) as CurrLevelID, @April AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 0 Level, e.Officer_ID as CurrLevelID, @April AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) as CurrLevelID, @May AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) as CurrLevelID, @May AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) as CurrLevelID, @May AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) as CurrLevelID, @May AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) as CurrLevelID, @May AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) as CurrLevelID, @May AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 0 Level, e.Officer_ID as CurrLevelID, @May AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) as CurrLevelID, @June AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) as CurrLevelID, @June AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) as CurrLevelID, @June AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) as CurrLevelID, @June AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) as CurrLevelID, @June AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) as CurrLevelID, @June AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 0 Level, e.Officer_ID as CurrLevelID, @June AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) as CurrLevelID, @July AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) as CurrLevelID, @July AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) as CurrLevelID, @July AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) as CurrLevelID, @July AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) as CurrLevelID, @July AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) as CurrLevelID, @July AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 0 Level, e.Officer_ID as CurrLevelID, @July AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL

SELECT DISTINCT 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) as CurrLevelID, @August AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) as CurrLevelID, @August AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) as CurrLevelID, @August AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) as CurrLevelID, @August AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) as CurrLevelID, @August AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) as CurrLevelID, @August AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 0 Level, e.Officer_ID as CurrLevelID, @August AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

--September
UNION ALL
SELECT DISTINCT 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) as CurrLevelID, @September AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) as CurrLevelID, @September AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) as CurrLevelID, @September AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) as CurrLevelID, @September AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) as CurrLevelID, @September AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) as CurrLevelID, @September AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 0 Level, e.Officer_ID as CurrLevelID, @September AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) as CurrLevelID, @October AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) as CurrLevelID, @October AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) as CurrLevelID, @October AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) as CurrLevelID, @October AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) as CurrLevelID, @October AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) as CurrLevelID, @October AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 0 Level, e.Officer_ID as CurrLevelID, @October AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) as CurrLevelID, @November AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) as CurrLevelID, @November AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) as CurrLevelID, @November AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) as CurrLevelID, @November AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) as CurrLevelID, @November AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) as CurrLevelID, @November AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 0 Level, e.Officer_ID as CurrLevelID, @November AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

--December
UNION ALL
SELECT DISTINCT 3 Level, substring(replace(e.Current_LevelKey,'|',''),13,6) as CurrLevelID, @December AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 4 Level, substring(replace(e.Current_LevelKey,'|',''),19,6) as CurrLevelID, @December AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 5 Level, substring(replace(e.Current_LevelKey,'|',''),25,6) as CurrLevelID, @December AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 6 Level, substring(replace(e.Current_LevelKey,'|',''),31,6) as CurrLevelID, @December AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 7 Level, substring(replace(e.Current_LevelKey,'|',''),37,6) as CurrLevelID, @December AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 8 Level, substring(replace(e.Current_LevelKey,'|',''),43,6) as CurrLevelID, @December AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

UNION ALL
SELECT DISTINCT 0 Level, e.Officer_ID as CurrLevelID, @December AsOfDateKey
, 0                                                                      Asset_Net_Spread_Margin
, 0                                                                      Liability_Net_Spread_Margin
, 0                                                                      Net_Loan_Fees
, 0                                                        Net_Depository_Fees
, 0                                                                      Letter_Of_Credit_Fees
, 0                                                                      Treasury_Management_Hard_Charges
, 0                                                                      Wealth_Management_Revenue
, 0                                                                      Card_Services_Net_Revenue
, 0                                                                      Card_Services_Fees
, 0                                                                      Net_Merchant_Services_Fees
, 0                                                                      Equipment_Finance_Revenue
, 0                                                                      Total_Fee_Revenue 
, 0                                                                      Manually_Captured_Revenue
, 0                                                                      Total_Net_Revenue
, 0                                                                      Expected_Loss
, 0                                                                      Excluded_Consumer_Revenue
, 0                                                                      Total_Performance_Revenue
FROM dim.employee e where e.Officer_Relationship_Type='Officer'

--ORDER BY Level ASC, CurrLevelID, ASOfDateKey ASC




